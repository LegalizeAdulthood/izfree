<HTML>
<HEAD>
<META name=VI60_defaultClientScript content=VBScript>
<META NAME="GENERATOR" Content="Microsoft Visual Studio 6.0">
<TITLE>Edit Dialog</TITLE>
<STYLE TYPE="text/css">
    TABLE.dialog
    {
        position: absolute;
        left: 50px;
        width: 250px;
        top: 50px;
        height: 250px;
        border-style: none;
        border: 0px 0px 0px 0px;
        margin: 0px 0px 0px 0px;
    }
    TD.content
    {
        position: relative;
        left: 10px;
        width: 250px;
        top: 9px;
        height: 250px;
        border-style: solid;
        border-width: 1px;
        background-color: green;
        z-index: 100;
    }
    TD.resize
    {
        position: absolute;
        border-style: none;
        background-color: black;
        height: 10px;
        width: 10px;
        z-index: 0;
    }
    TD#resize_tl
    {
        left: 0px;
        top: 0px;
    }
    TD#resize_t
    {
        left: 10px;
        top: 0px;
        width: 250px;
    }
    TD#resize_tr
    {
        left: 260px;
        top: 0px;
    }
    TD#resize_l
    {
        left: 0px;
        top: 10px;
        height: 250px;
    }
    TD#resize_r
    {
        left: 260px;
        top: 10px;
        height: 250px;
    }
    TD#resize_bl
    {
        left: 0px;
        top: 260px;
    }
    TD#resize_b
    {
        left: 10px;
        top: 260px;
        width: 250px;
    }
    TD#resize_br
    {
        left: 260px;
        top: 260px;
    }
</STYLE>
<LINK REL="stylesheet" HREF="izfree.css">
<SCRIPT TYPE="text/vbscript" LANGUAGE="vbscript">
dim drag : drag = false
dim x : x = 50
dim y : y = 50
dim width : width = 250
dim height : height = 250
dim start_x : start_x = 0
dim start_y : start_y = 0
dim source : source = ""
dim elem
dim el, et, ew, eh
const num_dbg_msgs = 50

sub dialog_onMouseDown
    set elem = window.event.srcElement
    drag = true
    elem.setCapture
    el = elem.offsetLeft
    et = elem.offsetTop
    ew = elem.offsetWidth
    eh = elem.offsetHeight
    source = elem.id
    start_x = window.event.clientX
    start_y = window.event.clientY
end sub

sub dialog_onMouseUp
    drag = false
    elem.releaseCapture
    
    dim delta_x : delta_x = window.event.clientX - start_x
    dim delta_y : delta_y = window.event.clientY - start_y
    select case source
        case "content"
            x = x + delta_x
            y = y + delta_y
            
        case "resize_l"
            width = width - delta_x
            x = x + delta_x
            
        case "resize_r"
            width = width + delta_x
    end select
end sub

sub dialog_onMouseMove
    if (drag) then
        dim resize_tl : set resize_tl = document.all("resize_tl")
        dim resize_t : set resize_t = document.all("resize_t")
        dim resize_tr : set resize_tr = document.all("resize_tr")
        dim resize_l : set resize_l = document.all("resize_l")
        dim resize_r : set resize_r = document.all("resize_r")
        dim resize_bl : set resize_bl = document.all("resize_bl")
        dim resize_b : set resize_b = document.all("resize_b")
        dim resize_br : set resize_br = document.all("resize_br")
        dim delta_x : delta_x = window.event.clientX - start_x
        dim delta_y : delta_y = window.event.clientY - start_y
        dim dlg_style : set dlg_style = document.all("dialog").style
        dbgout "start: " & x & "," & y & " " & width & "x" & height & "; " &_
            "delta: " & delta_x & "," & delta_y & "; left: " &_
            dlg_style.posleft & ", top: " & dlg_style.top & ", from: " &_
            window.event.srcElement.id
        dbgout _
            "r_tl: " & resize_tl.offsetLeft & "," & resize_tl.offsetTop & " " &_
                resize_tl.offsetWidth & "x" & resize_tl.offsetHeight & "; " &_
            "r_t: " & resize_t.offsetLeft & "," & resize_t.offsetTop & " " &_
                resize_t.offsetWidth & "x" & resize_t.offsetHeight & "; " &_
            "r_tr: " & resize_tr.offsetLeft & "," & resize_tr.offsetTop & " " &_
                resize_tr.offsetWidth & "x" & resize_tr.offsetHeight
        dbgout _
            "r_l: " & resize_l.offsetLeft & "," & resize_l.offsetTop & " " &_
                resize_l.offsetWidth & "x" & resize_l.offsetHeight & "; " &_
            "r_r: " & resize_r.offsetLeft & "," & resize_r.offsetTop & " " &_
                resize_r.offsetWidth & "x" & resize_r.offsetHeight
        dbgout _
            "r_bl: " & resize_bl.offsetLeft & "," & resize_bl.offsetTop & " " &_
                resize_bl.offsetWidth & "x" & resize_bl.offsetHeight & "; " &_
            "r_b: " & resize_b.offsetLeft & "," & resize_b.offsetTop & " " &_
                resize_b.offsetWidth & "x" & resize_b.offsetHeight & "; " &_
            "r_br: " & resize_br.offsetLeft & "," & resize_br.offsetTop & " " &_
                resize_br.offsetWidth & "x" & resize_br.offsetHeight
        dim new_width, l
        select case source
            case "resize_tl"
            case "resize_t"
            case "resize_tr"
            
            case "resize_l"
                new_width = width - delta_x
                l = delta_x
                'document.all("resize_tl").style.left = l
                'document.all("resize_t").style.left = l
                document.all("resize_t").style.width = new_width
                
                'document.all("resize_l").style.left = l
                dlg_style.left = el + delta_x + 50
                dlg_style.width = new_width
                
                'document.all("resize_bl").style.left = l
                'document.all("resize_b").style.left = l
                document.all("resize_b").style.width = new_width
                document.all("resize_r").style.left = new_width + 10
                document.all("resize_tr").style.left = new_width + 10
                document.all("resize_br").style.left = new_width + 10
               
            case "content"
                dlg_style.left = x + delta_x
                dlg_style.top = y + delta_y
                
            case "resize_r"
                new_width = width + delta_x
                l = new_width + 10
                document.all("resize_t").style.width = new_width & "px"
                document.all("resize_tr").style.left = l
                
                dlg_style.width = new_width
                document.all("resize_r").style.left = l
                
                document.all("resize_b").style.width = new_width
                document.all("resize_br").style.left = l
                
            case "resize_bl"
            case "resize_b"
            case "resize_br"
        end select
    end if
end sub

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'sub edit_dialog(dlg, db)
'   on error resume next
'   dim view : set view = db.openview("select * from `Dialog` where `Dialog` = '" & dlg & "'") : check
'   call view.execute : check
'   dim rec : set rec = view.fetch
'   call view.close : check
'    set view = nothing
'    if (rec is nothing) then
'        MsgBox("Dialog '" & dlg & "' does not exist in the database.")
'    else
'        ' dialog record
'        dim dump : dump = "'" & rec.stringdata(1) & "', " &_
'            rec.integerdata(2) & "," & rec.integerdata(3) & ", " &_
'            rec.integerdata(4) & "," & rec.integerdata(5) & ", " &_
'            rec.integerdata(6) & ", '" & rec.stringdata(7) & "', '" &_
'            rec.integerdata(8) & "', '" & rec.stringdata(9) & "', '" &_
'            rec.integerdata(10) & "'" & vbCRLF
'        ' control records
'        set view = db.openview("select * from `Control` where `Dialog` = '" & dlg & "'") : check
'        call view.execute : check
'        set rec = view.fetch
'        while not (rec is nothing)
'            dump = dump & "'" & rec.stringdata(1) & "', '" & rec.stringdata(2) &_
'            "', '" & rec.stringdata(3) & "', " & rec.integerdata(4) & "," &_
'            rec.integerdata(5) & ", " & rec.integerdata(6) & "," &_
'            rec.integerdata(7) & ", " & rec.integerdata(8) & ", '" &_
'            rec.stringdata(9) & "', '" & rec.stringdata(10) & "', '" &_
'            rec.stringdata(11) & "', '" & rec.stringdata(12) & "'" & vbCRLF
'            set rec = view.fetch
'        wend
'        set rec = nothing
'        MsgBox(dump)
'    end if
'end sub
</SCRIPT>
</HEAD>
<BODY>
<P><TABLE ID="dialog" CLASS="dialog" cellpadding=0 cellspacing=0>
<TR><TD ID="resize_tl" CLASS="resize"> </TD>
    <TD ID="resize_t"  CLASS="resize"> </TD>
    <TD ID="resize_tr" CLASS="resize"> </TD></TR>
<TR><TD ID="resize_l"  CLASS="resize"> </TD>
    <TD ID="content"   CLASS="content"> </TD>
    <TD ID="resize_r"  CLASS="resize"> </TD></TR>
<TR><TD ID="resize_bl" CLASS="resize"> </TD>
    <TD ID="resize_b"  CLASS="resize"> </TD>
    <TD ID="resize_br" CLASS="resize"> </TD></TR>
</TABLE></P>
<PRE>





















</PRE>
<P>Debug:<DIV ID="debug"></DIV></P>
</BODY>
</HTML>
