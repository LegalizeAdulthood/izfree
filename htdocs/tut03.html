<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>izfree Tutorial 3: Adding a Shortcut</TITLE>
</HEAD>
<BODY>

<H3>[ <A HREF="http://sourceforge.net/">SourceForge.net</A>
| <A HREF="http://sourceforge.net/projects/izfree/">Project</A>
| <A HREF="http://izfree.sourceforge.net/">izfree</A>
| <A HREF="tutorial.html">Tutorials</A>
| Tutorial 3 ]</H3>

<H2>Tutorial 3: Adding a Shortcut</H2>

<P>This tutorial extends the basic install to include a shortcut under
the <STRONG>Start</STRONG> / <STRONG>Programs</STRONG> menu to the file
'<CODE>ZOOM.TXT</CODE>'.</P>

<OL>
<LI><P>Open the database with Orca and select the
<STRONG>File</STRONG> table.  Locate the file you want to be the
target of the shortcut.  For zoom, its '<CODE>ZOOM.TXT</CODE>', whichhas a file key of <CODE>ZOOM.TXT_f1</CODE> in this example.</P>
<LI><P>We want to create a shortcut in the <CODE>Start</CODE> /<CODE>Programs</CODE> menu for the <CODE>All Users</CODE> profile.  First,we want to ensure that the installation is installed for all users.  To dothat, we add the <CODE>ALLUSERS</CODE> property to the <STRONG>Property</STRONG>table with a value of <CODE>1</CODE>.  Enter the following row into the<STRONG>Property</STRONG> table with Orca:</P><P><TABLE BORDER=1><THEAD><TR><TH>Property</TH><TH>Value</TH></TR></THEAD>
<TBODY><TR><TD><CODE>ALLUSERS</CODE></TD><TD><CODE>1</CODE></TD></TR></TBODY></TABLE><P><LI><P>Next, we need to describe the directory where the shortcut will belocated.  We can use the standard directory property
<CODE>ProgramMenuFolder</CODE>, which will be set to the proper directory
on the target machine when <CODE>ALLUSERS</CODE> is set to 1.  However, we
must still describe this directory in our installation.  To do that, weenter a row into the <STRONG>Directory</STRONG> table:</P>

<P><TABLE BORDER=1><THEAD><TR><TH>Directory</TH><TH>Directory_Parent</TH>
<TH>DefaultDir</TH></TR></THEAD><TBODY><TR><TD><CODE>ProgramMenuFolder</CODE></TD><TD><CODE>TARGETDIR</CODE></TD><TD><CODE>.</CODE></TD></TR>
</TBODY></TABLE></P>
<LI><P>Now we can create the shortcut.  Display the <STRONG>Shortcut</STRONG>
table and add a new row with the following columns, where NULL means
that the column is empty.</P>

<P><TABLE BORDER=1>
<TBODY>
<TR><TH>Shortcut</TH><TD><CODE>sctZooom</CODE></TD></TR>
<TR><TH>Directory_</TH><TD><CODE>ProgramMenuFolder</CODE></TD></TR>
<TR><TH>Name</TH><TD><CODE>Zoom Documentation</CODE></TD></TR>
<TR><TH>Component_</TH><TD><CODE>Documentation</CODE></TD></TR>
<TR><TH>Target</TH><TD><CODE>[#ZOOM.TXT_f1]</CODE></TD></TR>
<TR><TH>Arguments</TH><TD>NULL</TD></TR>
<TR><TH>Description</TH><TD><CODE>Zoom documentation</CODE></TD></TR>
<TR><TH>HotKey</TH><TD>NULL</TD></TR>
<TR><TH>Icon_</TH><TD>NULL</TD></TR>
<TR><TH>IconIndex</TH><TD>NULL</TD></TR>
<TR><TH>ShowCmd</TH><TD>NULL</TD></TR>
<TR><TH>WkDir</TH><TD>NULL</TD></TR>
</TBODY>
</TABLE>

<LI><P>Now validate the database to ensure that there are no errors
from editing.  Correct any mistakes made during editing and savethe corrected database.</P>

<P>The install now includes a working
shortcut in the <STRONG>Start</STRONG> / <STRONG>Programs</STRONG>
menu.  However, if you test this install you'll see that the shortcut
lacks an icon in the menu.</P>

<LI><P>Select an icon for your shortcut and save it as an icon (.ICO)
file.  We'll extract the icon from notepad and store it in the file
<CODE>c:\tmp\zoomtxt.ico</CODE>.  Display the <STRONG>Icon</STRONG> table and
add a new row.  Enter <CODE>icoZoom</CODE> for the
<STRONG>Name</STRONG> column and for the <STRONG>Data</STRONG> column,
enter the filename <CODE>c:\tmp\zoomtxt.ico</CODE> to import the icon
data into the column.</P>

<LI><P>Display the <STRONG>Shortcut</STRONG> table and highlight the
<STRONG>Icon_</STRONG> column for your shortcut.  Edit the value to be
<CODE>icoZoom</CODE>, the key for the new record in the
<STRONG>Icon_</STRONG> table.</P>

<LI><P>Validate your install once more, correcting any errors resulting
from editing.</P>

<LI><P>Save the modified database.</P>
</OL>

<HR><P><UL>
<LI><A HREF="tut01.html">Tutorial 1: The Basics</A>
<LI><A HREF="tut02.html">Tutorial 2: Remove Unnecessary Dialogs</A>
<LI>Tutorial 3: Adding a Shortcut
<LI><A HREF="tut04.html">Tutorial 4: Adding Shell Verbs</A>
<LI><A HREF="tut05.html">Tutorial 5: Registering a COM Object</A>
<LI><A HREF="tut06.html">Tutorial 6: Installing a Service</A>
</UL></P>

</BODY>
</HTML>
