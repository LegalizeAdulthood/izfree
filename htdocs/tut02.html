<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
<HEAD>
<TITLE>izfree Tutorial 2: Removing Unnecessary Dialogs</TITLE>
</HEAD>
<BODY>

<H3>[ <A HREF="http://sourceforge.net/">SourceForge.net</A>
| <A HREF="http://sourceforge.net/projects/izfree/">Project</A>
| <A HREF="http://izfree.sourceforge.net/">izfree</A>
| <A HREF="tutorial.html">Tutorials</A>
| Tutorial 2 ]</H3>

<H3>Tutorial 2: Removing Unnecessary Dialogs</H3>

<P>The installation created from Tutorial 1 gives you a
functioning installation database created from a set of templates.
There are three templates that are used to create the installation
database: a database schema, a collection of install sequences, and a
user interface.</P>

<UL>
<LI><P>The database schema contains database tables definitions for all the
Windows Installer database tables.</P>

<LI><P>The install sequences define the sequence of actions taken to
install a product onto the target machine.  The sequence template
contains database tables for the various sequences
(InstallExecuteSequence, InstallUISequence, etc.) that are populated
with the recommended default sequences from the SDK documentation.</P>

<LI><P>The user interface template contains a collection of dialogs to
guide the user through the installation process.  This database is
populated with the suggested sequence of dialogs in the SDK
documentation.</P>
</UL>

<P>Because these templates are very general, you will usually want to
refine the basic installation by editing the database with Orca.</P>

<P>In the case of 'zoom', you might want to remove the user
registration dialog and the license dialog.  To remove a dialog with
Orca, follow these steps.</P>

<OL>
<LI><P>Open the database with Orca and select the <STRONG>Dialog</STRONG>
table.</P>

<P><A HREF="images/tut04.png"><IMG WIDTH=400 HEIGHT=313 SRC=
"images/tut04.png.jpg"></A></P>

<LI><P>In the database rows pane, click the <STRONG>Dialog</STRONG>
column to sort the dialog rows by the name of the dialog.</P>

<P><A HREF="images/tut05.png"><IMG WIDTH=400 HEIGHT=313
SRC="images/tut05.png.jpg"></A></P>

<LI><P>Select the rows for the dialogs you wish to delete.
Select <STRONG>Edit</STRONG> / <STRONG>Cut Row(s)</STRONG>,
<STRONG>Tables</STRONG> / <STRONG>Drop Row(s)</STRONG>, or press the
<STRONG>Delete</STRONG> key to remove the rows from the table.</P>

<P><A HREF="images/tut06.png"><IMG WIDTH=400 HEIGHT=313
SRC="images/tut06.png.jpg"></A></P>

<LI><P>Now we remove the controls that were associated with those
dialogs.  Display the <STRONG>Control</STRONG> table and sort the rows
by the <STRONG>Dialog</STRONG> column.  Select the rows corresponding
to the controls on the deleted dialogs and remove them.</P>

<P><A HREF="images/tut07.png"><IMG WIDTH=400 HEIGHT=313
SRC="images/tut07.png.jpg"></A></P>

<LI><P>Display the <STRONG>ControlCondition</STRONG> table and sort
the rows by the <STRONG>Dialog</STRONG>
column.  Select any rows corresponding to the deleted dialogs and
remove them.</P>

<LI><P>Display the <STRONG>ControlEvent</STRONG> table and sort the
rows by the <STRONG>Dialog</STRONG>
column.  Select any rows corresponding to the deleted dialogs and
remove them.</P>

<LI><P>Now the dialogs and their controls have been cut out of the
middle of the dialog sequence.  However, the dialogs before and after
the removed dialogs still refer to the deleted dialogs with their Next
and Back buttons.</P>

<P>To find these dangling references, select <STRONG>Tools</STRONG>
/ <STRONG>Validate...</STRONG> from
the menu.  The validation dialog box appears.
Select Full MSI Validation Suite for the Evaluation File and click
Go.  This will validate the contents of the tables in the database.<P>

<P>Any informational, warning or error messages generated by the
internal consistency evaluators will be displayed in the validation
dialog box.  Click 'Close' to close the validation dialog box, and
Orca will then display the validation errors in a pane at the
bottom.</P>

<P><A HREF="images/tut08.png"><IMG WIDTH=400 HEIGHT=313
SRC="images/tut08.png.jpg"></A></P>

<LI><P>Correct the errors in the dialog sequence.  The original
sequence was as follows: <CODE>WelcomeDlg</CODE>,
<CODE>LicenseAgreementDlg</CODE>, <CODE>UserRegistrationDlg</CODE>,
<CODE>SetupTypeDlg</CODE>.  With the <CODE>LicenseAgreementDlg</CODE>
and <CODE>UserRegistrationDlg</CODE> removed, the sequence becomes:
<CODE>WelcomeDlg</CODE>, <CODE>SetupTypeDlg</CODE>.</P>

<P>In the <STRONG>ControlEvent</STRONG> table, modify the row for the
<CODE>Next</CODE> control on the <CODE>WelcomeDlg</CODE>.  Change the
<STRONG>Argument</STRONG> column to the value
<CODE>SetupTypeDlg</CODE>.</P>

<P>Similarly, modify the row for the <CODE>Back</CODE> control on the
<CODE>SetupTypeDlg</CODE>.  Change the <STRONG>Argument</STRONG>
column to the value <CODE>WelcomeDlg</CODE>.  There are two rows for
the <CODE>Back</CODE> control on the <CODE>SetupTypeDlg</CODE> with
different values for the <STRONG>Condition</STRONG> column.  Delete
one of the rows.  On the remaining row, change the value of the
<STRONG>Argument</STRONG> column to <CODE>WelcomeDlg</CODE> and NULL
out the <STRONG>Condition</STRONG> column.</P>

<P><A HREF="images/tut09.png"><IMG SRC="images/tut09.png.jpg"></A></P>

<LI><P>Revalidate the database to ensure that the sequence errors are
corrected and that no other errors have been made during editing.</P>

<P><A HREF="images/tut10.png"><IMG SRC="images/tut10.png.jpg"></A></P>

<LI><P>Save the modified database.</P>
</OL>

<P>You can follow the same steps in this tutorial to modify the
template database izfree uses to create your new package.  So that you
can keep the original database templates distributed with izfree,
make a copy of the templates directory before editing the templates.
Then tell izfree to use the new template location the next time you
use the New Package tool.</P>

<HR><UL>
<LI><A HREF="tut01.html">Tutorial 1: The Basics</A>
<LI>Tutorial 2: Remove Unnecessary Dialogs
<LI>Tutorial 3: Adding a Shortcut
<LI><A HREF="tut04.html">Tutorial 4: Initializing TARGETDIR</A>
<LI><A HREF="tut05.html">Tutorial 5: Adding Shell Verbs</A>
<LI><A HREF="tut06.html">Tutorial 6: Registering a COM Object</A>
<!--
<LI><A HREF="tut07.html">Tutorial 7: Installing a Service</A>
-->
</UL>

</BODY>
</HTML>
